name: Lint Code
description: Runs Commitlint, ESLint, TS check and Prettier to ensure code quality.

inputs:
  monorepo:
    default: 'false'
    description: "Set mode to 'monorepo' or 'single'."
    required: false

runs:
  using: composite
  steps:
    - name: Commitlint
      shell: bash
      run: |
        git log -1 --pretty=%B | pnpm exec commitlint

    - name: ESLint (monorepo)
      if: ${{ inputs.monorepo == true }}
      shell: bash
      run: |
        pnpm exec turbo run lint

    - name: ESLint
      if: ${{ inputs.monorepo != true }}
      shell: bash
      run: |
        pnpm eslint . --max-warnings=0

    - name: TS check (monorepo)
      if: ${{ inputs.monorepo == true }}
      shell: bash
      run: |
        pnpm exec turbo run typecheck

    - name: TS check
      if: ${{ inputs.monorepo != true }}
      shell: bash
      run: |
        tsc --noEmit --pretty

    - name: Prettier (monorepo)
      if: ${{ inputs.monorepo == true }}
      shell: bash
      run: |
        pnpm exec turbo run prettier:check

    - name: Prettier
      if: ${{ inputs.monorepo != true }}
      shell: bash
      run: |
        pnpm prettier --check .
